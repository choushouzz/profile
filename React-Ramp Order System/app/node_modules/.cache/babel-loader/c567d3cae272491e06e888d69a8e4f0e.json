{"ast":null,"code":"import _classCallCheck from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import\"./styles.css\";import Button from\"@material-ui/core/Button\";import Link from\"react-router-dom/Link\";import ListingBox from\"../Listings\";/* Primary Component for the Admin Dashboard page */var ClientDashboard=/*#__PURE__*/function(_React$Component){_inherits(ClientDashboard,_React$Component);var _super=_createSuper(ClientDashboard);function ClientDashboard(props){var _this;_classCallCheck(this,ClientDashboard);_this=_super.call(this,props);_this.state={error:null,isLoaded:false,userisLoaded:false,orders:[],users:[],username:localStorage.getItem(\"username\")||\"\"};return _this;}_createClass(ClientDashboard,[{key:\"componentWillMount\",value:function componentWillMount(){var _this2=this;// if(!this.state.isLoaded){\nthis.props.verifyTokens().then(function(valid){if(!valid)return;fetch(\"/users\",{method:'GET',headers:{'Accept':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token-access'))}}).then(function(res){if(res.ok)return res.json();throw new Error(\"Something went wrong with error code \".concat(res.status));}).then(function(result){var users=result[\"results\"];// users.map(x => {\n//   if (x[\"username\"] == this.props.username){\n//       id = x[\"pk\"]\n//   }\n// })\n_this2.handleUser(users);},// Note: it's important to handle errors here\n// instead of a catch() block so that we don't swallow\n// exceptions from actual bugs in components.\nfunction(error){_this2.setState({isLoaded:true,error:error});});// }\nif(_this2.state.isLoaded&&!_this2.state.userisLoaded){_this2.handleUser();}// TODO: we moved this here so calls are not being NON STOP made to the backend\n});}},{key:\"handleUser\",value:function handleUser(users){var _this3=this;this.props.verifyTokens().then(function(valid){if(!valid)return;fetch(\"/order-information/\",{method:'GET',headers:{'Accept':'application/json','Authorization':\"Bearer \".concat(localStorage.getItem('token-access'))}}).then(function(res){if(res.ok)return res.json();throw new Error(\"Something went wrong with error code \".concat(res.status));}).then(function(result){var orders=result[\"results\"];var user=users.find(function(x){return x[\"username\"]==_this3.state.username;});if(user){var results=orders.filter(function(x){return x[\"user\"]==user[\"pk\"];});_this3.setState({isLoaded:true,userisLoaded:true,orders:results});}else{// user wasn't found - return an error\n_this3.setState({isLoaded:true,error:\"User not found.\"});}},// Note: it's important to handle errors here\n// instead of a catch() block so that we don't swallow\n// exceptions from actual bugs in components.\nfunction(error){_this3.setState({userisLoaded:true,error:error});});});}},{key:\"render\",value:function render(){var _this4=this;var gotoFuncs=this.props.gotoFuncs;var orders=this.state.orders;var isLoaded=this.state.userisLoaded;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",{style:{textAlign:'center'}},\"Welcome to StopGap!\"),/*#__PURE__*/React.createElement(Link,{to:\"/form\"},/*#__PURE__*/React.createElement(Button,{className:\"newRequestButton\",color:\"primary\",variant:\"contained\",size:\"large\",style:{display:'block',marginLeft:'auto',marginRight:'auto',marginTop:'10%'}},\"Create New Ramp Request\")),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(ListingBox,{click:function click(data){return gotoFuncs.ramp_info(false,data,_this4.props.verifyTokens);},orders:orders,isAdmin:this.props.isAdmin,isLoaded:isLoaded}));}}]);return ClientDashboard;}(React.Component);export default ClientDashboard;","map":{"version":3,"sources":["C:/Users/owner/desktop/team/app/src/components/react-components/Dashboard/client_dash.js"],"names":["React","Button","Link","ListingBox","ClientDashboard","props","state","error","isLoaded","userisLoaded","orders","users","username","localStorage","getItem","verifyTokens","then","valid","fetch","method","headers","res","ok","json","Error","status","result","handleUser","setState","user","find","x","results","filter","gotoFuncs","textAlign","display","marginLeft","marginRight","marginTop","data","ramp_info","isAdmin","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport \"./styles.css\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Link from \"react-router-dom/Link\";\r\nimport ListingBox from \"../Listings\";\r\n\r\n/* Primary Component for the Admin Dashboard page */\r\nclass ClientDashboard extends React.Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      error: null,\r\n      isLoaded: false,\r\n      userisLoaded: false,\r\n      orders: [],\r\n      users:[],\r\n      username: localStorage.getItem(\"username\") || \"\"\r\n    }\r\n  }\r\n\r\n\r\n  componentWillMount()  {\r\n    // if(!this.state.isLoaded){\r\n    this.props.verifyTokens().then(valid => {\r\n      if (!valid)\r\n        return;\r\n      fetch(\"/users\", {\r\n        method: 'GET',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n          'Authorization': `Bearer ${localStorage.getItem('token-access')}`\r\n        }\r\n      })\r\n      .then(res => {\r\n        if (res.ok)\r\n          return res.json()\r\n        throw new Error(`Something went wrong with error code ${res.status}`)\r\n      })\r\n      .then(\r\n        (result) => {\r\n          const users = result[\"results\"];\r\n          // users.map(x => {\r\n          //   if (x[\"username\"] == this.props.username){\r\n          //       id = x[\"pk\"]\r\n  \r\n                \r\n          //   }\r\n          // })\r\n          this.handleUser(users)\r\n        },\r\n        // Note: it's important to handle errors here\r\n        // instead of a catch() block so that we don't swallow\r\n        // exceptions from actual bugs in components.\r\n        (error) => {\r\n          this.setState({\r\n            isLoaded: true,\r\n            error\r\n          });\r\n        }\r\n      )\r\n      // }\r\n  \r\n      if (this.state.isLoaded && !this.state.userisLoaded){\r\n        this.handleUser()\r\n      } // TODO: we moved this here so calls are not being NON STOP made to the backend\r\n    });\r\n  }\r\n\r\n  handleUser(users) {\r\n    this.props.verifyTokens().then(valid => {\r\n      if (!valid)\r\n        return;\r\n      fetch(\"/order-information/\", {\r\n        method: 'GET',\r\n        headers: {\r\n          'Accept': 'application/json',\r\n          'Authorization': `Bearer ${localStorage.getItem('token-access')}`\r\n        }\r\n      })\r\n      .then(res => {\r\n        if (res.ok)\r\n          return res.json()\r\n        throw new Error(`Something went wrong with error code ${res.status}`)\r\n      })\r\n      .then(\r\n        (result) => {\r\n          const orders = result[\"results\"];\r\n          \r\n          const user = users.find(x => x[\"username\"] == this.state.username)\r\n    \r\n          if (user){\r\n          \r\n            const results = orders.filter(x => x[\"user\"] == user[\"pk\"])\r\n            \r\n            this.setState({\r\n              isLoaded: true,\r\n              userisLoaded:true,\r\n              orders: results\r\n            });\r\n          } else {\r\n            // user wasn't found - return an error\r\n            this.setState({\r\n              isLoaded: true,\r\n              error: \"User not found.\"\r\n            });\r\n          }\r\n          \r\n        },\r\n        // Note: it's important to handle errors here\r\n        // instead of a catch() block so that we don't swallow\r\n        // exceptions from actual bugs in components.\r\n        (error) => {\r\n          this.setState({\r\n            userisLoaded:true,\r\n            error\r\n          });\r\n        }\r\n      )\r\n    })\r\n  }\r\n  \r\n\r\n  render() {\r\n\r\n    const gotoFuncs = this.props.gotoFuncs;\r\n    const orders= this.state.orders;\r\n    const isLoaded = this.state.userisLoaded;\r\n    return (\r\n      <div>\r\n        <h1 style={{ textAlign: 'center' }}>\r\n          Welcome to StopGap!\r\n        </h1>\r\n        <Link to='/form'>\r\n          <Button\r\n            className=\"newRequestButton\"\r\n            color=\"primary\" variant=\"contained\" size='large'\r\n            style={{ display: 'block', marginLeft: 'auto', marginRight: 'auto', marginTop: '10%' }}>\r\n            Create New Ramp Request\r\n          </Button>\r\n        </Link>\r\n        <br />\r\n        <br />\r\n        <ListingBox click={(data) => gotoFuncs.ramp_info(false,data, this.props.verifyTokens)} orders={orders} isAdmin = { this.props.isAdmin} isLoaded={isLoaded}/>\r\n        {/* <ListingBox click={(id) => this.props.gotoFuncs.ramp_info(false,id)} /> */}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ClientDashboard;\r\n"]},"metadata":{},"sourceType":"module"}