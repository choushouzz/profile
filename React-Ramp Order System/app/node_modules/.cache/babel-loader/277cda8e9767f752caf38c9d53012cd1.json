{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"C:\\\\Users\\\\owner\\\\Desktop\\\\team\\\\app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import React from\"react\";import ProgressBar from\"../ProgressBar\";import Button from\"@material-ui/core/Button\";import Grid from\"@material-ui/core/Grid\";import{Select,MenuItem,InputLabel}from\"@material-ui/core\";import{sizing}from'@material-ui/system';var StatusBlock=/*#__PURE__*/function(_React$Component){_inherits(StatusBlock,_React$Component);var _super=_createSuper(StatusBlock);function StatusBlock(props){var _this;_classCallCheck(this,StatusBlock);_this=_super.call(this,props);_this.handleStatusInput=function(e){_this.setState({statusInput:_this.statuses.indexOf(e.target.value)});};_this.saveData=function(e){e.preventDefault();// TODO: make post request\nvar new_status=_this.state.statusInput;var data=_this.state.data;data[\"status\"]=_this.statuses[new_status];_this.setState({status:new_status,data:data});_this.handle();};_this.statuses=[\"Request Recieved\",\"Request Accepted\",\"Build Phase\",\"Paint Phase\",\"Out for Delivery\",\"Completed\"];_this.statuses[-1]=\"--\";_this.state={data:_this.props.data,error:null,isLoaded:false,date:\"\",statusInput:0,status:-1// progress: (0 / (this.statuses.length - 1)) * 100,\n};return _this;}_createClass(StatusBlock,[{key:\"componentDidMount\",value:function componentDidMount(){var new_progress=\"status\"in this.props.data?this.statuses.indexOf(this.props.data[\"status\"]):-1;if(new_progress>=this.statuses.length||new_progress<-1){new_progress=-1;}this.setState({// status: this.state.data[\"status\"],\ndate:this.state.data[\"date_created\"],isLoaded:true,status:new_progress,statusInput:new_progress});}},{key:\"handle\",value:function handle(){var _this2=this;var data=this.state.data;console.log(this.state);var token=localStorage.getItem('token-access');var requestOptions={method:'PUT',headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},body:JSON.stringify(data)};var link='/order-information/'+data[\"pk\"];fetch(link,requestOptions).then(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(response){var error;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(response.ok){_context.next=3;break;}// get error message from body or default to response status\nerror=data&&data.message||response.status;return _context.abrupt(\"return\",Promise.reject(error));case 3:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}()).catch(function(error){_this2.setState({errorMessage:error});console.error('There was an error!',error);});}},{key:\"render\",value:function render(){var _this$state=this.state,status=_this$state.status,statusInput=_this$state.statusInput,date=_this$state.date,error=_this$state.error,isLoaded=_this$state.isLoaded;var statusMsg=this.statuses[statusInput];var progress=statusInput/(this.statuses.length-1);if(error){return/*#__PURE__*/React.createElement(\"div\",null,\" Error: \",error.message);}else if(!isLoaded){return/*#__PURE__*/React.createElement(\"div\",null,\"Loading...\");}else{var dirtyBit=statusInput!=status;return/*#__PURE__*/React.createElement(\"div\",{className:\"block\"},/*#__PURE__*/React.createElement(\"h2\",{className:\"block-title\"},\"Status\"),/*#__PURE__*/React.createElement(\"span\",{className:\"status-block-last-updated\"},\"Initial Request Date: \",/*#__PURE__*/React.createElement(\"strong\",null,date)),/*#__PURE__*/React.createElement(ProgressBar,{progress:progress}),/*#__PURE__*/React.createElement(\"span\",{className:\"status-block-status\"},statusMsg,/*#__PURE__*/React.createElement(\"br\",null)),this.props.isAdmin&&/*#__PURE__*/React.createElement(Grid,{container:true},/*#__PURE__*/React.createElement(Grid,{item:true,md:10},/*#__PURE__*/React.createElement(Select,{className:\"status-bar-textfield\",value:statusMsg,onChange:this.handleStatusInput,type:\"number\",variant:\"outlined\"},this.statuses.map(function(status,i){return/*#__PURE__*/React.createElement(MenuItem,{value:status,key:i},status);}))),/*#__PURE__*/React.createElement(Grid,{item:true,md:2},/*#__PURE__*/React.createElement(Button,{fullWidth:true,variant:\"contained\",color:\"primary\",disabled:!dirtyBit,onClick:this.saveData},\"Save\"))));}}}]);return StatusBlock;}(React.Component);export default StatusBlock;","map":{"version":3,"sources":["C:/Users/owner/desktop/team/app/src/components/react-components/Dashboard/RampInfoPage/StatusBlock.js"],"names":["React","ProgressBar","Button","Grid","Select","MenuItem","InputLabel","sizing","StatusBlock","props","handleStatusInput","e","setState","statusInput","statuses","indexOf","target","value","saveData","preventDefault","new_status","state","data","status","handle","error","isLoaded","date","new_progress","length","console","log","token","localStorage","getItem","requestOptions","method","headers","body","JSON","stringify","link","fetch","then","response","ok","message","Promise","reject","catch","errorMessage","statusMsg","progress","dirtyBit","isAdmin","map","i","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport ProgressBar from \"../ProgressBar\";\r\nimport Button from \"@material-ui/core/Button\";\r\nimport Grid from \"@material-ui/core/Grid\";\r\nimport {Select, MenuItem, InputLabel} from \"@material-ui/core\";\r\nimport { sizing } from '@material-ui/system';\r\n\r\nclass StatusBlock extends React.Component {\r\n\r\n  constructor(props){\r\n    super(props);\r\n    this.statuses = [\r\n      \"Request Recieved\",\r\n      \"Request Accepted\",\r\n      \"Build Phase\",\r\n      \"Paint Phase\",\r\n      \"Out for Delivery\",\r\n      \"Completed\"\r\n    ];\r\n    this.statuses[-1] = \"--\"\r\n\r\n    this.state = {\r\n      data:this.props.data,\r\n      error: null,\r\n      isLoaded: false,\r\n      date:\"\",\r\n      statusInput: 0,\r\n      status: -1\r\n      // progress: (0 / (this.statuses.length - 1)) * 100,\r\n    };\r\n  }  \r\n\r\n\r\n\r\n\r\n  handleStatusInput = e => {\r\n    this.setState({\r\n      statusInput: this.statuses.indexOf(e.target.value)\r\n    });\r\n  }\r\n\r\n  componentDidMount() {\r\n    let new_progress = \"status\" in this.props.data ? this.statuses.indexOf(this.props.data[\"status\"]) : -1\r\n    if (new_progress >= this.statuses.length || new_progress < -1){\r\n      new_progress = -1;\r\n    }\r\n    this.setState({\r\n      // status: this.state.data[\"status\"],\r\n      date: this.state.data[\"date_created\"],\r\n      isLoaded: true,\r\n      status: new_progress,\r\n      statusInput: new_progress\r\n    });\r\n  }\r\n\r\n  handle(){\r\n    const data = this.state.data\r\n    console.log(this.state)\r\n    \r\n\t\tconst token = localStorage.getItem('token-access')\r\n    const requestOptions = {\r\n          method: 'PUT',\r\n          headers: {\r\n\t\t\t\t      'Content-Type': 'application/json',\r\n\t\t\t\t      'Authorization': 'Bearer ' + token\r\n\t\t      },\r\n            body: JSON.stringify(data)\r\n    };\r\n    const link =  '/order-information/' + data[\"pk\"]\r\n    fetch(link, requestOptions)\r\n          .then(async response => {\r\n          // const data = await response.json();\r\n    \r\n          // check for error response\r\n          if (!response.ok) {\r\n              // get error message from body or default to response status\r\n              const error = (data && data.message) || response.status;\r\n              return Promise.reject(error);\r\n          }\r\n\t\t\t\t    //  console.log(data.pk)\r\n            // this.setState({ postId: data.pk })\r\n    })\r\n    .catch(error => {\r\n        this.setState({ errorMessage: error });\r\n        console.error('There was an error!', error);\r\n    }); \r\n\r\n  }\r\n\r\n  saveData = e => {\r\n    e.preventDefault();\r\n    // TODO: make post request\r\n    const new_status = this.state.statusInput;\r\n    var data = this.state.data\r\n    data[\"status\"] = this.statuses[new_status]\r\n    this.setState({\r\n      status:new_status,\r\n      data:data\r\n    })\r\n    this.handle()\r\n  }\r\n\r\n  render() {\r\n    const { status, statusInput, date, error, isLoaded } = this.state;\r\n    const statusMsg = this.statuses[statusInput];\r\n    const progress = (statusInput / (this.statuses.length - 1));\r\n    if (error) {\r\n      return <div> Error: {error.message}</div>\r\n    }\r\n    else if (!isLoaded) {\r\n      return <div>Loading...</div>\r\n    }\r\n    else{\r\n\r\n    const dirtyBit = statusInput != status;\r\n\r\n    return (\r\n      <div className={\"block\"}>\r\n        <h2 className={\"block-title\"}>\r\n          Status\r\n        </h2>\r\n        <span className={\"status-block-last-updated\"}>\r\n          Initial Request Date: <strong>\r\n            {date}\r\n          </strong>\r\n        </span>\r\n        <ProgressBar progress={progress} />\r\n        <span className={\"status-block-status\"} > \r\n          {statusMsg}\r\n          <br/>\r\n        </span>\r\n        { this.props.isAdmin &&\r\n          <Grid container>\r\n            <Grid item md={10}>\r\n              <Select\r\n                className = {\"status-bar-textfield\"}\r\n                value={statusMsg}\r\n                onChange={this.handleStatusInput}\r\n                type=\"number\"\r\n                variant=\"outlined\"\r\n              >\r\n                {this.statuses.map((status, i) => <MenuItem value={status} key={i}>{status}</MenuItem>)}\r\n                \r\n              </Select>\r\n            </Grid>\r\n\r\n            <Grid item md={2}>\r\n              <Button fullWidth variant=\"contained\" color=\"primary\" disabled={!dirtyBit} onClick={this.saveData}>Save</Button>\r\n            </Grid>\r\n          </Grid>\r\n        }\r\n      </div>\r\n    );\r\n  }\r\n}\r\n}\r\n\r\nexport default StatusBlock;"]},"metadata":{},"sourceType":"module"}